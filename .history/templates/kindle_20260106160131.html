<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=1072, height=1448, initial-scale=1.0, user-scalable=no"
    />
    <title>Kindle Dash - ç¦»çº¿çœ‹æ¿</title>
    <style>
      {{ kindle_css }}
    </style>
  </head>
  <body>
    <!-- ==================== ä¸»å†…å®¹åŒº ==================== -->
    <main id="content">
      <!-- Module A: Deep Tech (ArXiv è®ºæ–‡) -->
      <section id="tab-papers" class="tab-content active">
        <h1 class="section-title">Deep Tech</h1>
        <p class="section-subtitle">ArXiv æœ€æ–°è®ºæ–‡ç²¾é€‰</p>

        {% if papers %} {% for paper in papers %}
        <article class="paper-card">
          <h2 class="paper-title">{{ paper.title_with_ipa | safe }}</h2>
          <p class="paper-meta">
            <span class="authors">{{ paper.authors | join(', ') }}</span>
            <span class="date">{{ paper.published }}</span>
          </p>

          <div class="paper-abstract">
            <p class="abstract-en">{{ paper.abstract_en }}</p>
            <hr class="divider" />
            <p class="abstract-zh">{{ paper.abstract_zh }}</p>
          </div>
        </article>
        {% endfor %} {% else %}
        <p class="empty-state">æš‚æ— è®ºæ–‡æ•°æ®</p>
        {% endif %}
      </section>

      <!-- Module B: GitHub Trending AI -->
      <section id="tab-repos" class="tab-content">
        <h1 class="section-title">GitHub Trending</h1>
        <p class="section-subtitle">è¿‘æœŸ AI çƒ­é—¨é¡¹ç›®</p>

        {% if repos %}
        <ul class="repo-list">
          {% for repo in repos %}
          <li class="repo-item">
            <span class="repo-stars">â˜… {{ repo.stars }}</span>
            <div class="repo-info">
              <strong class="repo-name">{{ repo.name }}</strong>
              <p class="repo-desc">
                {{ repo.description_zh or repo.description_en }}
              </p>
            </div>
          </li>
          {% endfor %}
        </ul>
        {% else %}
        <p class="empty-state">æš‚æ— ä»“åº“æ•°æ®</p>
        {% endif %}
      </section>

      <!-- Module C: Mental Models (æ€ç»´æ¨¡å‹) -->
      <section id="tab-models" class="tab-content">
        <h1 class="section-title">Mental Models</h1>
        <p class="section-subtitle">æ€ç»´æ¨¡å‹é—ªå¡</p>

        {% if models %}
        <div id="flashcard-container">
          {% for model in models %}
          <div
            class="flashcard {% if loop.first %}active{% endif %}"
            data-index="{{ loop.index0 }}"
          >
            <h2 class="model-name-en">{{ model.name_en }}</h2>
            <h3 class="model-name-zh">{{ model.name_zh }}</h3>
            <hr class="divider" />
            <p class="model-desc">{{ model.description_zh }}</p>
            <p class="model-example"><em>ä¾‹ï¼š{{ model.example }}</em></p>
            <p class="model-source">â€” {{ model.source }}</p>
          </div>
          {% endfor %}
        </div>
        <div class="flashcard-nav">
          <span id="card-indicator">1 / {{ models | length }}</span>
          <button id="btn-next-card" class="nav-btn">ä¸‹ä¸€å¼  â†’</button>
        </div>
        {% else %}
        <p class="empty-state">æš‚æ— æ€ç»´æ¨¡å‹æ•°æ®</p>
        {% endif %}
      </section>

      <!-- Module D: Focus & Quotes (ä¸“æ³¨ä¸è¯­å½•) -->
      <section id="tab-focus" class="tab-content">
        <div id="focus-screen" class="focus-active">
          <h1 class="focus-text">FOCUS</h1>
          <p class="focus-hint">ç‚¹å‡»å±å¹•æŸ¥çœ‹è¯­å½•</p>
        </div>

        <div id="quote-screen" class="quote-hidden">
          {% if quotes %} {% for quote in quotes %}
          <div
            class="quote-card {% if loop.first %}active{% endif %}"
            data-index="{{ loop.index0 }}"
          >
            {% if quote.language == 'zh' %}
            <p class="quote-content-zh vertical">{{ quote.content }}</p>
            {% else %}
            <p class="quote-content-en">{{ quote.content }}</p>
            {% if quote.translation %}
            <p class="quote-translation">{{ quote.translation }}</p>
            {% endif %} {% endif %}
            <p class="quote-author">â€” {{ quote.author }}</p>
          </div>
          {% endfor %}
          <div class="quote-nav">
            <button id="btn-next-quote" class="nav-btn">ä¸‹ä¸€æ¡ â†’</button>
          </div>
          {% else %}
          <p class="empty-state">æš‚æ— è¯­å½•æ•°æ®</p>
          {% endif %}
        </div>
      </section>

      <!-- Module E: Lyrics (æ­Œè¯æœ¬) -->
      <section id="tab-lyrics" class="tab-content">
        <h1 class="section-title">Lyrics</h1>
        <p class="section-subtitle">æ­Œè¯æœ¬</p>

        <!-- æ­Œæ›²ç›®å½• -->
        <div id="lyrics-index">
          {% if lyrics %}
          <ul class="lyrics-list">
            {% for song in lyrics %}
            <li class="lyrics-item" data-song="{{ loop.index0 }}">
              <span class="song-number">{{ loop.index }}.</span>
              <span class="song-name">{{ song.name }}</span>
            </li>
            {% endfor %}
          </ul>
          {% else %}
          <p class="empty-state">æš‚æ— æ­Œè¯æ•°æ®</p>
          {% endif %}
        </div>

        <!-- æ­Œè¯è¯¦æƒ… -->
        <div id="lyrics-detail" class="hidden">
          {% for song in lyrics %}
          <div class="lyrics-content" data-song="{{ loop.index0 }}">
            <h2 class="song-title">{{ song.name }}</h2>
            <div class="lyrics-text">
              {% for line in song.lines %}
              <p>{{ line }}</p>
              {% endfor %}
            </div>
          </div>
          {% endfor %}
          <button id="btn-back-index" class="nav-btn">â† è¿”å›ç›®å½•</button>
        </div>
      </section>
    </main>

    <!-- ==================== åº•éƒ¨å¯¼èˆªæ  ==================== -->
    <nav id="tab-bar">
      <button class="tab-btn active" data-tab="papers">
        <span class="tab-icon">ğŸ“„</span>
        <span class="tab-label">è®ºæ–‡</span>
      </button>
      <button class="tab-btn" data-tab="repos">
        <span class="tab-icon">â­</span>
        <span class="tab-label">GitHub</span>
      </button>
      <button class="tab-btn" data-tab="models">
        <span class="tab-icon">ğŸ§ </span>
        <span class="tab-label">æ€ç»´</span>
      </button>
      <button class="tab-btn" data-tab="focus">
        <span class="tab-icon">ğŸ’¡</span>
        <span class="tab-label">è¯­å½•</span>
      </button>
      <button class="tab-btn" data-tab="lyrics">
        <span class="tab-icon">ğŸµ</span>
        <span class="tab-label">æ­Œè¯</span>
      </button>
    </nav>

    <!-- ==================== JavaScript äº¤äº’ ==================== -->
    <script>
      // Tab åˆ‡æ¢
      document.querySelectorAll(".tab-btn").forEach((btn) => {
        btn.addEventListener("click", function () {
          const tabId = this.dataset.tab;

          // æ›´æ–° Tab æŒ‰é’®çŠ¶æ€
          document
            .querySelectorAll(".tab-btn")
            .forEach((b) => b.classList.remove("active"));
          this.classList.add("active");

          // æ›´æ–°å†…å®¹åŒºæ˜¾ç¤º
          document
            .querySelectorAll(".tab-content")
            .forEach((c) => c.classList.remove("active"));
          document.getElementById("tab-" + tabId).classList.add("active");
        });
      });

      // æ€ç»´æ¨¡å‹é—ªå¡åˆ‡æ¢
      let currentCardIndex = 0;
      const cards = document.querySelectorAll(".flashcard");
      const cardIndicator = document.getElementById("card-indicator");

      document
        .getElementById("btn-next-card")
        ?.addEventListener("click", function () {
          cards[currentCardIndex].classList.remove("active");
          currentCardIndex = (currentCardIndex + 1) % cards.length;
          cards[currentCardIndex].classList.add("active");
          cardIndicator.textContent =
            currentCardIndex + 1 + " / " + cards.length;
        });

      // Focus ä¸è¯­å½•åˆ‡æ¢
      const focusScreen = document.getElementById("focus-screen");
      const quoteScreen = document.getElementById("quote-screen");

      focusScreen?.addEventListener("click", function () {
        focusScreen.classList.remove("focus-active");
        focusScreen.classList.add("focus-hidden");
        quoteScreen.classList.remove("quote-hidden");
        quoteScreen.classList.add("quote-active");
      });

      // è¯­å½•åˆ‡æ¢
      let currentQuoteIndex = 0;
      const quoteCards = document.querySelectorAll(".quote-card");

      document
        .getElementById("btn-next-quote")
        ?.addEventListener("click", function () {
          quoteCards[currentQuoteIndex].classList.remove("active");
          currentQuoteIndex = (currentQuoteIndex + 1) % quoteCards.length;
          quoteCards[currentQuoteIndex].classList.add("active");
        });

      // æ­Œè¯ç›®å½•ä¸è¯¦æƒ…åˆ‡æ¢
      const lyricsIndex = document.getElementById("lyrics-index");
      const lyricsDetail = document.getElementById("lyrics-detail");
      const lyricsContents = document.querySelectorAll(".lyrics-content");

      document.querySelectorAll(".lyrics-item").forEach((item) => {
        item.addEventListener("click", function () {
          const songIndex = this.dataset.song;
          lyricsIndex.classList.add("hidden");
          lyricsDetail.classList.remove("hidden");

          lyricsContents.forEach((c) => c.classList.remove("active"));
          document
            .querySelector(`.lyrics-content[data-song="${songIndex}"]`)
            .classList.add("active");
        });
      });

      document
        .getElementById("btn-back-index")
        ?.addEventListener("click", function () {
          lyricsDetail.classList.add("hidden");
          lyricsIndex.classList.remove("hidden");
        });
    </script>

    <!-- ç”Ÿæˆæ—¶é—´ -->
    <footer class="generated-info">ç”Ÿæˆäº {{ generated_at }}</footer>
  </body>
</html>
